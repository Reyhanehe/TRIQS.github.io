<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Measurements: definitions &mdash; TRIQS Hybridization Expansion Segment Solver 1.4.0 documentation</title>
    
    <link rel="stylesheet" href="_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="TRIQS Hybridization Expansion Segment Solver 1.4.0 documentation" href="contents.html" />
    <link rel="next" title="Provenance" href="provenance.html" />
    <link rel="prev" title="Solver Accessors" href="accessors.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="_static/cufon-yui.js" type="text/javascript"></script>
    <script src="_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    
    <li><a href="install.html">Install</a></li>
    
    <li><a href="contents.html">Documentation</a></li>
    
    <li><a href="issues.html">Issues</a></li>
    
    <li><a href="about.html">About CTSEG</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="index.html">ctseg</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">an optimized quantum impurity solver based on the <a class="triqs" style="font-size: 12px" href="http://ipht.cea.fr/triqs">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="provenance.html" title="Provenance"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="accessors.html" title="Solver Accessors"
             accesskey="P">previous</a> |</li>
    <li><a href="index.html">Home</a> &raquo;</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Measurements: definitions</a><ul>
<li><a class="reference internal" href="#green-s-function">Green&#8217;s function</a><ul>
<li><a class="reference internal" href="#imaginary-time">Imaginary time</a></li>
<li><a class="reference internal" href="#matsubara-frequencies">Matsubara frequencies</a></li>
<li><a class="reference internal" href="#legendre-polynomial-basis">Legendre polynomial basis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#density-density-correlation-function">Density-density correlation function</a></li>
<li><a class="reference internal" href="#two-frequency-quantities">Two-frequency quantities</a><ul>
<li><a class="reference internal" href="#two-frequency-correlation-functions">Two-frequency correlation functions</a></li>
<li><a class="reference internal" href="#vertex-function">Vertex function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#three-frequency-quantities">Three-frequency quantities</a><ul>
<li><a class="reference internal" href="#three-frequency-correlation-functions">Three-frequency correlation functions</a></li>
<li><a class="reference internal" href="#id1">Vertex function</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="accessors.html"
                        title="previous chapter">Solver Accessors</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="provenance.html"
                        title="next chapter">Provenance</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/observables.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-cthyb_segment"></span><div class="section" id="measurements-definitions">
<span id="options"></span><h1>Measurements: definitions<a class="headerlink" href="#measurements-definitions" title="Permalink to this headline">¶</a></h1>
<p>Here we list all the observables that can be measured by the solver along with their definition. Each measurement can be turned on or off via the corresponding <a class="reference internal" href="accessors.html"><em>switch</em></a>.</p>
<div class="section" id="green-s-function">
<h2>Green&#8217;s function<a class="headerlink" href="#green-s-function" title="Permalink to this headline">¶</a></h2>
<p>The single-particle Green&#8217;s function can be measured in imaginary time, Matsubara frequencies or the Legendre basis (see <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevB.84.075145">L. Boehnke et al., Phys. Rev. B 84, 075145 (2011)</a>).</p>
<p>In addition, we provide measurements of the so-called improved estimators (see <a class="reference external" href="http://dx.doi.org/10.1103/PhysRevB.85.205106">H. Hafermann et al., Phys. Rev. B 85, 205106 (2012)</a>), which
allow an accurate evaluation of the self-energy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The accuracy gain of improved estimators goes together with a performance penalty, which is larger when dynamical interactions are involved. The overhead occurs if the improved estimator for any measurement is turned on. The corresponding part is shared among different measurements, so there is no additional penalty if the improved estimator is measured for more than one observable.</p>
</div>
<div class="section" id="imaginary-time">
<h3>Imaginary time<a class="headerlink" href="#imaginary-time" title="Permalink to this headline">¶</a></h3>
<p>The imaginary-time Green&#8217;s function is defined as</p>
<div class="math">
\[G_a(\tau) = -\langle T_\tau c_a(\tau)c_a^\dagger(0) \rangle\]</div>
<p>and the corresponding improved estimator is given by</p>
<div class="math">
\[\begin{split}\begin{align}
F_a(\tau) &amp;= F_a^{\text{st}}(\tau) + F_a^{\text{ret}}(\tau)\\
F_a^{\text{st}}(\tau) &amp;= -\sum_b \langle T_\tau n_b(\tau) U_{ba} c_a(\tau)c_a^\dagger(0) \rangle\\
F_a^{\text{ret}}(\tau) &amp;= -\int_0^\beta d\tilde{\tau} \sum_b \langle T_\tau n_b(\tilde{\tau}) U^{\text{ret}}_{ba}(\tilde{\tau}-\tau) c_a(\tau)c_a^\dagger(0) \rangle
\end{align}\end{split}\]</div>
<p>where <span class="math">\(F^{\text{st}}\)</span> and <span class="math">\(F^{\text{ret}}\)</span> denote the contributions due to the static
and retarded parts of the interaction.</p>
<p>These measurements are turned on by setting <code class="docutils literal"><span class="pre">measure_gt</span></code> and <code class="docutils literal"><span class="pre">measure_ft</span></code> to <code class="docutils literal"><span class="pre">True</span></code>, respectively.
The number of time points on the grid is specified through <code class="docutils literal"><span class="pre">n_tau_g</span></code> and is the same for both observables.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The imaginary-time measurement is most efficient. The performance of the algorithm does not scale
with the number of points in the grid on which it is measured, so this number can and should be
chosen large. By Nyquist&#8217;s theorem, the Fourier transform will correctly reproduce the function
in the frequency domain on the first <span class="math">\(N_\omega\approx N_\tau/4\pi\)</span> frequencies.</p>
</div>
</div>
<div class="section" id="matsubara-frequencies">
<h3>Matsubara frequencies<a class="headerlink" href="#matsubara-frequencies" title="Permalink to this headline">¶</a></h3>
<p>In the frequency measurement, the solver measures the Fourier transform of the Green&#8217;s function and the improved estimator on positive Matsubara frequencies <span class="math">\(\omega_n=(2n+1)\pi/\beta\)</span>, <span class="math">\(n=0,\ldots,n_\omega-1\)</span>.</p>
<div class="math">
\[\begin{split}G_a(i\omega) &amp;= \int_0^\beta d\tau\, e^{i\omega_n\tau} G_a(\tau)\\
F_a(i\omega) &amp;= \int_0^\beta d\tau\, e^{i\omega_n\tau} F_a(\tau)\end{split}\]</div>
<p>The switches for these measurements are <code class="docutils literal"><span class="pre">measure_gw</span></code> and <code class="docutils literal"><span class="pre">measure_fw</span></code>. The number of frequencies is specified through <code class="docutils literal"><span class="pre">n_w</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the improved estimator is measured on Matsubara frequencies, the self-energy is automatically
computed at the end of the simulations as <span class="math">\(\Sigma_a(i\omega)=F_a(i\omega)/G_a(i\omega)\)</span>.</p>
</div>
</div>
<div class="section" id="legendre-polynomial-basis">
<h3>Legendre polynomial basis<a class="headerlink" href="#legendre-polynomial-basis" title="Permalink to this headline">¶</a></h3>
<p>The Legendre coefficients of the Green&#8217;s function and the improved estimator are defined as</p>
<div class="math">
\[\begin{split}\begin{align}
G_a(l) &amp;= \sqrt{2l+1}\int_0^\beta d\tau\, P_l[x(\tau)] G_a(\tau)\\
F_a(l) &amp;= \sqrt{2l+1}\int_0^\beta d\tau\, P_l[x(\tau)] F_a(\tau)
\end{align}\end{split}\]</div>
<p>where <span class="math">\(x(\tau)=2\tau/\beta-1\)</span>.
These measurements are controlled through the switches and parameter <code class="docutils literal"><span class="pre">meaure_gl</span></code>, <code class="docutils literal"><span class="pre">measure_fl</span></code> and <code class="docutils literal"><span class="pre">n_legendre_g</span></code>.</p>
<p>The Legendre Green&#8217;s function may be transformed to the Matsubara basis through the unitary transformation</p>
<div class="math">
\[G_a(i\omega_n) = \sum_{l\geq 0}T_{nl} G_a(l)\]</div>
<p>where</p>
<div class="math">
\[T_{nl} = (-1)^ni^{l+1}\sqrt{2l+1}j_l\left(\frac{(2n+1)\pi}{2}\right)\]</div>
<p>with the spherical Bessel functions <span class="math">\(j_l(z)\)</span>.</p>
</div>
</div>
<div class="section" id="density-density-correlation-function">
<h2>Density-density correlation function<a class="headerlink" href="#density-density-correlation-function" title="Permalink to this headline">¶</a></h2>
<p>The measurement of the imaginary-time density-density correlation function</p>
<div class="math">
\[\chi^{ab}(\tau) = \langle T_\tau n_a(\tau)n_b(0) \rangle\]</div>
<p>is triggered through the switch <code class="docutils literal"><span class="pre">measure_nnt</span></code>.
In contrast to the Green&#8217;s function, the measurement slows down considerably with the number of points <code class="docutils literal"><span class="pre">n_tau_nn</span></code> on the grid.</p>
<p>In most cases, it is more efficicient to measure it on Matsubara frequencies as specified through <code class="docutils literal"><span class="pre">measure_nnw</span></code>:</p>
<div class="math">
\[\chi^{ab}(i\nu_m) = \int_0^\beta d\tau\, e^{i\nu_m\tau} \chi^{ab}(\tau)\]</div>
<p>where the number of bosonic frequencies <span class="math">\(\nu_m=2m\pi/\beta\)</span> is specified through <code class="docutils literal"><span class="pre">n_w_b_nn</span></code>.</p>
</div>
<div class="section" id="two-frequency-quantities">
<h2>Two-frequency quantities<a class="headerlink" href="#two-frequency-quantities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="two-frequency-correlation-functions">
<h3>Two-frequency correlation functions<a class="headerlink" href="#two-frequency-correlation-functions" title="Permalink to this headline">¶</a></h3>
<p>We define the following imaginary-time correlation functions:</p>
<div class="math">
\[G^{(2)}_{ab}(\tau,\tau',\tau'') = -\langle T_\tau c_a(\tau)c_a^\dagger(\tau')n_b(\tau'') \rangle\]\[\begin{split}\begin{align}
F^{(2)}_{ab}(\tau,\tau',\tau'') &amp;= F_{ab}^{(2),\text{st}}(\tau,\tau',\tau'') + F_{ab}^{(2),\text{ret}}(\tau,\tau',\tau'')\\
F_{ab}^{(2),\text{st}}(\tau,\tau',\tau'') &amp;= -\sum_{a'} \langle T_\tau n_{a'}(\tau) U_{a'a} c_a(\tau)c_a^\dagger(\tau')n_b(\tau'') \rangle\\
F_{ab}^{(2),\text{ret}}(\tau,\tau',\tau'') &amp;= -\int_0^\beta d\tilde{\tau} \sum_{a'} \langle T_\tau n_{a'}(\tilde{\tau}) U^{\text{ret}}_{a'a}(\tilde{\tau}-\tau) c_a(\tau)c_a^\dagger(\tau')n_b(\tau'') \rangle
\end{align}\end{split}\]</div>
<p>The code provides measurements for the Fourier transform of these quantities, defined as</p>
<div class="math">
\[\begin{split}\begin{align}
 G^{(2)}_{ab}(i\omega,i\nu) &amp;= \frac{1}{\beta}\int_0^\beta d\tau \int_0^\beta d\tau' \int_0^\beta d\tau'' e^{i\omega_n\tau}e^{-i(\omega_n+\nu_m)\tau'} e^{i\nu_m\tau''} G^{(2)}_{ab}(\tau,\tau',\tau'')\\
 \end{align}\end{split}\]</div>
<p>and analogously for the improved estimator.
The number of fermionic (bosonic) frequencies is specified through the parameters <code class="docutils literal"><span class="pre">n_w_f_vertex</span></code> (<code class="docutils literal"><span class="pre">n_w_b_vertex</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently only the frequency measurement is provided.</p>
</div>
</div>
<div class="section" id="vertex-function">
<h3>Vertex function<a class="headerlink" href="#vertex-function" title="Permalink to this headline">¶</a></h3>
<p>If one or two of the two-frequency correlation functions have been measured and the parameter <code class="docutils literal"><span class="pre">evaluate_vertex</span></code> is set to <code class="docutils literal"><span class="pre">true</span></code>, the following vertex function is computed in the charge channel:</p>
<div class="math">
\[\lambda_a(i\omega,i\nu) = \frac{1}{\chi^{\text{ch}}(i\nu)}\left(\frac{G^{(2),\text{con}}_{a}(i\omega,i\nu)}{G_a(i\omega)G_a(i\omega+i\nu)} -1\right)\]</div>
<p>where the charge susceptibility <span class="math">\(\chi^\text{ch}(i\nu)\)</span> is defined as</p>
<div class="math">
\[\chi^\text{ch}(i\nu) = -\sum_{ab} \left[\chi_{ab}(i\nu)-\langle n_a\rangle \langle n_b\rangle \delta_{\nu} \right]\]</div>
<p>and where, depending on which two-frequency correlation functions have been measured, the connected part is computed in either of the following ways:</p>
<div class="math">
\[\begin{split}\begin{align}
G^{(2),\text{con}}_{a}(i\omega,i\nu) &amp;= \sum_b G^{(2)}_{ab}(i\omega,i\nu) - \sum_b G^{(2),\text{disc}}_{ab}(i\omega,i\nu)\\
G^{(2),\text{con}}_{a}(i\omega,i\nu) &amp;= G_a(i\omega) \sum_b F_{ab}^{(2)}(i\omega,i\nu)-F_a(i\omega) \sum_b G_{ab}^{(2)}(i\omega,i\nu)\\
G^{(2),\text{con}}_{a}(i\omega,i\nu) &amp;= \Big[G_a(i\omega) \sum_b F_{ab}^{(2)}(i\omega,i\nu)-F_a(i\omega) \sum_b G_{ab}^{(2),\text{disc}}(i\omega,i\nu)\Big]/[1+F_a(i\omega)].
\end{align}\end{split}\]</div>
<p>Here the disconnected part of the correlation function has been defined as</p>
<div class="math">
\[G^{(2),\text{disc}}_{ab}(i\omega,i\nu) = \beta G_a(i\omega)\langle n_b\rangle\delta_{\nu}-G_a(i\omega) G_a(i\omega+i\nu)\delta_{ab}.\]</div>
</div>
</div>
<div class="section" id="three-frequency-quantities">
<h2>Three-frequency quantities<a class="headerlink" href="#three-frequency-quantities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="three-frequency-correlation-functions">
<h3>Three-frequency correlation functions<a class="headerlink" href="#three-frequency-correlation-functions" title="Permalink to this headline">¶</a></h3>
<p>We define the following imaginary-time correlation functions:</p>
<div class="math">
\[G^{(3)}_{ab}(\tau,\tau',\tau'') = \langle T_\tau c_a(\tau)c_a^\dagger(\tau')c_b(\tau'')c_b^\dagger(0) \rangle\]\[\begin{split}\begin{align}
F^{(3)}_{ab}(\tau,\tau',\tau'') &amp;= F_{ab}^{(3),\text{st}}(\tau,\tau',\tau'') + F_{ab}^{(3),\text{ret}}(\tau,\tau',\tau'')\\
F_{ab}^{(3),\text{st}}(\tau,\tau',\tau'') &amp;= \sum_{a'} \langle T_\tau n_{a'}(\tau) U_{a'a} c_a(\tau)c_a^\dagger(\tau')c_b(\tau'')c_b^\dagger(0) \rangle\\
F_{ab}^{(3),\text{ret}}(\tau,\tau',\tau'') &amp;= \int_0^\beta d\tilde{\tau} \sum_{a'} \langle T_\tau n_{a'}(\tilde{\tau}) U^{\text{ret}}_{a'a}(\tilde{\tau}-\tau) c_a(\tau)c_a^\dagger(\tau')c_b(\tau'')c_b^\dagger(0) \rangle
\end{align}\end{split}\]</div>
<p>The code provides measurements for the Fourier transform of these quantities, defined as</p>
<div class="math">
\[\begin{split}\begin{align}
 G^{(3)}_{ab}(i\omega,i\omega',i\nu) &amp;= \frac{1}{\beta}\int_0^\beta d\tau \int_0^\beta d\tau' \int_0^\beta d\tau'' e^{i\omega_n\tau}e^{-i(\omega_n+\nu_m)\tau'}e^{i(\omega'_n+\nu_m)\tau'} e^{-i\omega'_n\tau''} G^{(3)}_{ab}(\tau,\tau',\tau'')\\
 \end{align}\end{split}\]</div>
<p>and analogously for the improved estimator.
The number of fermionic (bosonic) frequencies is specified through the parameters <code class="docutils literal"><span class="pre">n_w_f_vertex</span></code> (<code class="docutils literal"><span class="pre">n_w_b_vertex</span></code>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently only the frequency measurement is provided.</p>
</div>
</div>
<div class="section" id="id1">
<h3>Vertex function<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>If one or two of the three-frequency correlation functions have been measured and the parameter <code class="docutils literal"><span class="pre">evaluate_vertex</span></code> is set to <code class="docutils literal"><span class="pre">true</span></code>, the following vertex function is computed at the end of the simulation:</p>
<div class="math">
\[\gamma_{ab}(i\omega,i\omega',i\nu) = \frac{G^{(3),\text{con}}_{ab}(i\omega,i\omega',i\nu)}{G_a(i\omega)G_a(i\omega+i\nu)G_b(i\omega'+i\nu)G_b(i\omega')}\]</div>
<p>Depending on which two-frequency correlation functions have been measured, the connected part is computed in either of the following ways:</p>
<div class="math">
\[\begin{split}\begin{align}
G^{(3),\text{con}}_{a}(i\omega,i\omega',i\nu) &amp;= G^{(3)}_{ab}(i\omega,i\omega',i\nu) - G^{(3),\text{disc}}_{ab}(i\omega,i\omega',i\nu)\\
G^{(3),\text{con}}_{a}(i\omega,i\omega',i\nu) &amp;= G_a(i\omega) F_{ab}^{(3)}(i\omega,i\omega',i\nu)-F_a(i\omega) G_{ab}^{(3)}(i\omega,i\omega',i\nu)\\
G^{(3),\text{con}}_{a}(i\omega,i\omega',i\nu) &amp;= \Big[G_a(i\omega) F_{ab}^{(3)}(i\omega,i\omega',i\nu)-F_a(i\omega) G_{a}^{(3),\text{disc}}(i\omega,i\omega',i\nu)\Big]/[1+F_a(i\omega)].
\end{align}\end{split}\]</div>
<p>The disconnected part of the correlation function has been defined as</p>
<div class="math">
\[G^{(2),\text{disc}}_{ab}(i\omega,i\omega',i\nu) = \beta G_{a}(i\omega)G_b(i\omega')\delta_{\nu}-\beta G_a(i\omega) G_a(i\omega+i\nu)\delta_{\omega,\omega'}\delta_{ab}.\]</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="provenance.html" title="Provenance"
             >next</a> |</li>
        <li class="right" >
          <a href="accessors.html" title="Solver Accessors"
             >previous</a> |</li>
    <li><a href="index.html">Home</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2013-2016, T. Ayral, H. Hafermann, M. Ferrero, O. Parcollet.
    </div>
  </body>
</html>