..
   Generated automatically using the command:
   c++2doc.py -N applications -N impurity_solvers /var/lib/jenkins/jobs/cthyb_spin_gcc5/workspace/triqs_src/doc/reference/common.hpp --output_directory=/var/lib/jenkins/jobs/cthyb_spin_gcc5/workspace/build/doc/reference --includes=/var/lib/jenkins/jobs/cthyb_spin_gcc5/workspace/triqs_src/c++ --includes=/var/lib/jenkins/jobs/triqs_gcc5/workspace/build/INSTALL_DIR/include --includes=/var/lib/jenkins/jobs/triqs_gcc5/workspace/build/INSTALL_DIR/share/triqs/cmake --mako_location=/var/lib/jenkins/jobs/triqs_gcc5/workspace/build/INSTALL_DIR/share/triqs

.. highlight:: c


.. _precompute_Mw:

precompute_Mw
===============

**Synopsis**:

.. code-block:: c

      class precompute_Mw;

precomputes the Fourier transform of the M-matrix and nM-matrix



.. math::
		M_\sigma(w_1,w_2) = \sum_{ij} M_^{\sigma}_{ji} e^{i w_1 \tau_i} e^{-i w_2 \tau_j}

..



.. math::
		nM_\sigma(w_1,w_2) = \sum_{ij} I^\sigma_j M^{\sigma}_{ji} e^{i w_1 \tau_i} e^{-i w_2 \tau_j}

..

   The measurement of :math:`I^\sigma_j` is done in :ref:`precompute_fprefactor`.


.. note::
     needed for the measurement of vertex functions




Public members
-----------------

+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| Member        | Type                                                                         | Comment                                                                     |
+===============+==============================================================================+=============================================================================+
| p             | const triqs::applications::impurity_solvers::ctqmc_seg::solve_parameters_t * |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| params        | const triqs::applications::impurity_solvers::ctqmc_seg::qmc_parameters *     |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| config        | const triqs::applications::impurity_solvers::ctqmc_seg::configuration *      |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| Mw            | std::vector<arrays::array<dcomplex, 4> >                                     |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| nMw           | std::vector<arrays::array<dcomplex, 4> >                                     | M-matrix left-multiplied by density operator; needed for improved estimator |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| fprefactor    | std::shared_ptr<precompute_fprefactor>                                       |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| n_w_fermionic | int                                                                          |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| n_w_bosonic   | int                                                                          |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| n_w_aux       | int                                                                          |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| n_w_aux_1     | int                                                                          |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| n_w_aux_2     | int                                                                          |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| beta          | double                                                                       |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| w_ini         | double                                                                       |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| w_inc         | double                                                                       |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| c_exp_ini     | arrays::vector<dcomplex>                                                     |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| c_exp_inc     | arrays::vector<dcomplex>                                                     |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| cdag_exp_ini  | arrays::vector<dcomplex>                                                     |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+
| cdag_exp_inc  | arrays::vector<dcomplex>                                                     |                                                                             |
+---------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------+


Member functions
-----------------

+------------------------------------------------+-----------------------------------------------------+
| Member function                                | Comment                                             |
+================================================+=====================================================+
| :ref:`constructor <precompute_Mw_constructor>` |                                                     |
+------------------------------------------------+-----------------------------------------------------+
| :ref:`getM <precompute_Mw_getM>`               |                                                     |
+------------------------------------------------+-----------------------------------------------------+
| :ref:`getnM <precompute_Mw_getnM>`             |                                                     |
+------------------------------------------------+-----------------------------------------------------+
| :ref:`operator() <precompute_Mw_operator()>`   | call operator which performs the actual computation |
+------------------------------------------------+-----------------------------------------------------+

.. toctree::
  :hidden:

   precompute_Mw/constructor
   precompute_Mw/getM
   precompute_Mw/getnM
   precompute_Mw/operator()