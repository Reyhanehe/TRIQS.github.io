.. highlight:: c

.. _gf_tail:

High frequency tail
===========================

Implementation
--------------

In TRIQS, the tail is implemented as an object ``tail``.

A simple example
~~~~~~~~~~~~~~~~~~~~

.. triqs_example:: ./tail_0.cpp

API
~~~~

Here are the main methods of the ``tail`` class:

+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| Member                          | Description                                                                             | Type                     |
+=================================+=========================================================================================+==========================+
| data()                          | 3-dim array of the coefficients: ``data(i,n,m)`` :math:`=(\mathbf{a}_{i+o_{min}})_{nm}` | data_view_type           |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| mask_view()                     | 2-dim (:math:`N_1 \times N_2`) array of the maximum non-zero indices                    | mask_view_type           |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| order_min()                     | minimum order                                                                           | long                     |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| order_max()                     | maximum order                                                                           | long                     |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| size()                          | first dim of data()                                                                     | size_t                   |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| shape()                         | shape of data()                                                                         | shape_type               |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| smallest_nonzeros()             | order of the smallest_nonzero coefficient                                               | long                     |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| is_decreasing_at_infinity()     | true if the tail is decreasing at infinity                                              | bool                     |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| operator() (int n)              | matrix_valued coefficient :math:`(\mathbf{a}_i)_{nm}`                                   | mv_type                  |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| get_or_zero (int n)             | matrix_valued coefficient :math:`(\mathbf{a}_i)_{nm}`                                   | const_mv_type            |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
| evaluate(dcomplex const &omega) | value of the tail at frequency omega                                                    | arrays::matrix<dcomplex> |
+---------------------------------+-----------------------------------------------------------------------------------------+--------------------------+
    
   
The tail is DefaultConstructible, H5Serializable and BoostSerializable.


Fitting the tail of a Green's function
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Given an imaginary-frequency Green's function, one can compute the moments of its high-frequency tail with the function ``fit_tail``:


.. triqs_example:: ./tail_1.cpp
The full documentation of ``fit_tail`` is :doc:`here<fit_tail>`.
