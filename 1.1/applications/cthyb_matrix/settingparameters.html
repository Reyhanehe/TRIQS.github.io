
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Setting the parameters &mdash; TRIQS Hybridization Expansion Matrix Solver 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="top" title="TRIQS Hybridization Expansion Matrix Solver 1.0.0 documentation" href="index.html" />
    <link rel="up" title="Documentation" href="documentation.html" />
    <link rel="next" title="The solver concept" href="concept.html" />
    <link rel="prev" title="The Solver class" href="reference.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="_static/cufon-yui.js" type="text/javascript"></script>
    <script src="_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body>
<div class="pageheader">
  <ul>
    
    <li><a href="install.html">Install</a></li>
    
    <li><a href="documentation.html">Documentation</a></li>
    
    <li><a href="issues.html">Issues</a></li>
    
    <li><a href="about.html">About CTHYB</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="index.html">cthyb</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">a quantum impurity solver based on the <a class="triqs" style="font-size: 12px" href="http://ipht.cea.fr/triqs">TRIQS</a> library</span>
  </div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="concept.html" title="The solver concept"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reference.html" title="The Solver class"
             accesskey="P">previous</a> |</li>
    <li><a href="index.html">Home</a> &raquo;</li>

          <li><a href="documentation.html" accesskey="U">Documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Setting the parameters</a><ul>
<li><a class="reference internal" href="#step-1-construct-the-solver-instance">Step 1 - construct the solver instance</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-2-the-hamiltonian">Step 2 - the Hamiltonian</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-3-the-quantum-numbers">Step 3 - the quantum numbers</a><ul>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-4-can-i-use-the-segment-picture">Step 4 - can I use the segment picture?</a></li>
<li><a class="reference internal" href="#step-5-the-monte-carlo-parameters">Step 5 - the Monte Carlo parameters</a></li>
<li><a class="reference internal" href="#step-6-how-many-legendre-coefficients">Step 6 - how many Legendre coefficients?</a></li>
<li><a class="reference internal" href="#step-7-prepare-the-non-interacting-green-s-function">Step 7 - prepare the non-interacting Green&#8217;s function</a></li>
<li><a class="reference internal" href="#step-8-we-re-ready-to-go">Step 8 - we&#8217;re ready to go!</a></li>
<li><a class="reference internal" href="#final-step-analyze-the-output">Final Step - analyze the output</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="reference.html"
                        title="previous chapter">The Solver class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="concept.html"
                        title="next chapter">The solver concept</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/settingparameters.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="setting-the-parameters">
<h1>Setting the parameters<a class="headerlink" href="#setting-the-parameters" title="Permalink to this headline">¶</a></h1>
<p>Here&#8217;s a step-by-step guide that should show you how to prepare a CTQMC run.
Take the time to go through this little guide as it can help you avoid doing
simple mistakes.</p>
<div class="section" id="step-1-construct-the-solver-instance">
<h2>Step 1 - construct the solver instance<a class="headerlink" href="#step-1-construct-the-solver-instance" title="Permalink to this headline">¶</a></h2>
<p>At first you need to create an instance of the CTQMC solver class. This is done
with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pytriqs.operators</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pytriqs.applications.impurity_solvers.cthyb_matrix</span> <span class="kn">import</span> <span class="n">Solver</span>

<span class="c"># Create a solver instance</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="n">beta</span> <span class="o">=</span> <span class="n">invT</span><span class="p">,</span> <span class="n">gf_struct</span> <span class="o">=</span> <span class="n">struct</span><span class="p">)</span>
</pre></div>
</div>
<p>The first parameter of the solver is the inverse temperature. In order to
complete the construction of the instance, you need to figure out what is the
correct structure of the Green&#8217;s function for the problem you are considering.
As emphasized earlier, you should always try to take advantage of a possible
block structure of the Green&#8217;s function.  In a spin system, the Green&#8217;s
function can often be cut into <em>up</em> and <em>down</em> spin sectors.</p>
<p>When the structure is clear you can set the parameter <tt class="docutils literal"><span class="pre">gf_struct</span></tt> which is
a list of tuples describing the Green&#8217;s function blocks. Each of these tuples
has two elements: a string giving the name of the block and a list of the indices
of the block.</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">For a single-band Hubbard model with a local Coulomb interaction, the Green&#8217;s function
can be cut in two up/down blocks of size 1. We would have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gf_struct</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="p">]</span>
</pre></div>
</div>
</li>
<li><p class="first">For a two-band Hubbard model with a hybridization between the bands, the Green&#8217;s function
can be cut in two up/down blocks, but there are off-diagonal orbital elements. We have:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gf_struct</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="step-2-the-hamiltonian">
<h2>Step 2 - the Hamiltonian<a class="headerlink" href="#step-2-the-hamiltonian" title="Permalink to this headline">¶</a></h2>
<p>The solver instance is ready. Now you need to prepare all the parameters
that will enter the <tt class="docutils literal"><span class="pre">solve</span></tt> method and start the calculation. So
the next step is to describe the local Hamiltonian. This is the Hamiltonian
acting on the effective impurity sites/orbitals. It is very important to
<strong>include only the quartic terms and not the quadratic terms</strong> in this
Hamiltonian. The latter terms will be computed from the kownledge of the
non-interacting Green&#8217;s function <tt class="docutils literal"><span class="pre">S.G0</span></tt> as explained below (see Step 7). The
Hamiltonian is given in the parameter <tt class="docutils literal"><span class="pre">H_local</span></tt> with the use of
<a class="reference external" href="http://docs.python.org/2.7/reference/lexical_analysis.html#operators" title="(in Python v2.7)"><em>Operators</em></a>. The arguments in the parenthesis of the <tt class="docutils literal"><span class="pre">C()</span></tt>, <tt class="docutils literal"><span class="pre">Cdag()</span></tt>
and <tt class="docutils literal"><span class="pre">N()</span></tt> operators must be compatible with the structure of the Green&#8217;s
function <tt class="docutils literal"><span class="pre">gf_struct</span></tt>.</p>
<div class="section" id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">For a single-band Hubbard model with a local Coulom interaction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">H_local</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Two-orbital Hubbard model, no inter-orbital interaction, but a hybridization
between the bands (this term will not appear in the local Hamiltonian!):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">H_local</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="step-3-the-quantum-numbers">
<h2>Step 3 - the quantum numbers<a class="headerlink" href="#step-3-the-quantum-numbers" title="Permalink to this headline">¶</a></h2>
<p>In order to improve the speed of the solver, it is important to use as many
quantum numbers as possible. These quantum numbers are the eigenvalues of a set
of symmetry <em>operators</em> that commute with the Hamiltonian. In other words, the
local eigenstates will be organized so that they are both eigenvectors of the
Hamiltonian and of the quantum number operators.  Note that the symmetries
corresponding to the quantum numbers must be <em>abelian</em> symmetries.  The quantum
number operators are given as a dictionary in the parameter
<tt class="docutils literal"><span class="pre">quantum_numbers</span></tt>.  The key is a string that describes the quantum number and
the value is the corresponding operator (see <a class="reference external" href="http://docs.python.org/2.7/reference/lexical_analysis.html#operators" title="(in Python v2.7)"><em>Operators</em></a>).</p>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">For a single-band Hubbard model with a local Coulom interaction:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">quantum_numbers</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;Number of up spins&#39;</span> <span class="p">:</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s">&#39;Number of down spins&#39;</span> <span class="p">:</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">If we consider a two-band Hubbard model with a fully SU(2) Hund&#8217;s exchange:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Ntot</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">Sz</span> <span class="o">=</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">quantum_numbers</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;Total N&#39;</span> <span class="p">:</span> <span class="n">Ntot</span><span class="p">,</span> <span class="s">&#39;Total spin along z&#39;</span> <span class="p">:</span> <span class="n">Sz</span> <span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="step-4-can-i-use-the-segment-picture">
<h2>Step 4 - can I use the segment picture?<a class="headerlink" href="#step-4-can-i-use-the-segment-picture" title="Permalink to this headline">¶</a></h2>
<p>In the special case where <em>all</em> the operators <tt class="docutils literal"><span class="pre">N(a,alpha)</span></tt> are good quantum
number operators (i.e. they all commute with the Hamiltonian), one can improve
the algorithm and use the so-called <em>segment picture</em>. This case is special
because then all construction and destruction operators are just a number
between the local eigenstates. If you are in this situation you should turn the
parameter <tt class="docutils literal"><span class="pre">use_segment_picture</span></tt> to <tt class="docutils literal"><span class="pre">True</span></tt>. For example, the segment picture
can be used for all Hamiltonians that are purely density-density. On the
contrary the segment picture cannot be used for a two-band Hubbard model with a
full SU(2) Hund&#8217;s exchange.</p>
</div>
<div class="section" id="step-5-the-monte-carlo-parameters">
<h2>Step 5 - the Monte Carlo parameters<a class="headerlink" href="#step-5-the-monte-carlo-parameters" title="Permalink to this headline">¶</a></h2>
<p>There are three parameters that control how many steps and measures are done
during the Monte Carlo sampling. <tt class="docutils literal"><span class="pre">n_cycles</span></tt> is the total number of measurment
cycles done. A cycle has <tt class="docutils literal"><span class="pre">length_cycle</span></tt> Monte Carlo moves in it.  The
measurments start after <tt class="docutils literal"><span class="pre">n_warmup_cycles</span></tt> cycles have been made and there is
a measurment at the end of every cycle. At the end of the run, there will be
<tt class="docutils literal"><span class="pre">n_Cycles</span></tt> measurments and a total of (<tt class="docutils literal"><span class="pre">n_cycles</span></tt> + <tt class="docutils literal"><span class="pre">n_warmup_cycles</span></tt>) x
<tt class="docutils literal"><span class="pre">length_cycle</span></tt> moves.</p>
<p>When the solver is spread on a parallel machine, each core will do <tt class="docutils literal"><span class="pre">n_cycles</span></tt>
measurments cycles and <tt class="docutils literal"><span class="pre">n_warmup_cycles</span></tt> warmup cycles. Therefore the same
input run on a larger number of cores will yield a larger statistics.</p>
</div>
<div class="section" id="step-6-how-many-legendre-coefficients">
<h2>Step 6 - how many Legendre coefficients?<a class="headerlink" href="#step-6-how-many-legendre-coefficients" title="Permalink to this headline">¶</a></h2>
<p>The CTQMC algorithm computes the Green&#8217;s function on the imaginary-time
interval <span class="math">\([0,\beta]\)</span>. In order to gain memory and to reduce
high-frequency noise, the Green&#8217;s function is expanded on a basis of
<tt class="docutils literal"><span class="pre">n_legendre</span></tt> Legendre polynomials.  The question is, how many of these
polynomials should one use? Our recommendation is to do a first <em>test</em> run
with a large number of coefficients, say 80. When the run is over, one
can inspect the Legendre Green&#8217;s function and decide how many coefficients
should be kept. This will be detailed below.</p>
</div>
<div class="section" id="step-7-prepare-the-non-interacting-green-s-function">
<h2>Step 7 - prepare the non-interacting Green&#8217;s function<a class="headerlink" href="#step-7-prepare-the-non-interacting-green-s-function" title="Permalink to this headline">¶</a></h2>
<p>The last step before starting the solver is to prepare the non-interacting
Green&#8217;s function of the problem. From the knowledge of this Green&#8217;s function,
the solver can extract the hybridization function used in the algorithm and the
quadratic terms of the local Hamiltonian. The non-interacting Green&#8217;s function
must be initialized in the member <tt class="docutils literal"><span class="pre">G0</span></tt> of the solver instance. For example,
one would write:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">spin</span><span class="p">,</span> <span class="n">g0</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">G0</span><span class="p">:</span>
  <span class="n">g0</span> <span class="o">&lt;&lt;=</span> <span class="n">inverse</span><span class="p">(</span> <span class="n">iOmega_n</span> <span class="o">-</span> <span class="n">e_f</span> <span class="o">-</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Wilson</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>to initialize the Green&#8217;s function of an impurity imbedded in a flat
conduction bath.</p>
</div>
<div class="section" id="step-8-we-re-ready-to-go">
<h2>Step 8 - we&#8217;re ready to go!<a class="headerlink" href="#step-8-we-re-ready-to-go" title="Permalink to this headline">¶</a></h2>
<p>Everything is ready at this stage and you just need to call the <tt class="docutils literal"><span class="pre">solve()</span></tt>
member of the solver with all the information you prepared, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">H_local</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">quantum_numbers</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;Nup&#39;</span> <span class="p">:</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;up&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s">&#39;Ndown&#39;</span> <span class="p">:</span> <span class="n">N</span><span class="p">(</span><span class="s">&#39;down&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">},</span>
        <span class="n">use_segment_picture</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
        <span class="n">n_cycles</span>  <span class="o">=</span> <span class="mi">500000</span><span class="p">,</span>
        <span class="n">length_cycle</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
        <span class="n">n_warmup_cycles</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
        <span class="n">n_legendre</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>When you call the solver, the local Hamiltonian (with the quadratic terms) is
shown. Be careful to check that this is indeed the Hamiltonian that you expect!
At the end of the run, the solver has computed the following objects:</p>
<blockquote>
<div><ul class="simple">
<li>The interacting Green&#8217;s function of the problem on the Matsubara frequency
axis. This is in the class member <tt class="docutils literal"><span class="pre">G</span></tt>.</li>
<li>The interacting Legendre Green&#8217;s function of the problem. This is put
in the member <tt class="docutils literal"><span class="pre">G_legendre</span></tt>. This output is useful to decide how many
Legendre coefficients should be used.</li>
<li>The self-energy on the Matsubara frequency axis. This is in the member <tt class="docutils literal"><span class="pre">Sigma</span></tt>.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="final-step-analyze-the-output">
<h2>Final Step - analyze the output<a class="headerlink" href="#final-step-analyze-the-output" title="Permalink to this headline">¶</a></h2>
<p>The final step is to decide on the ideal number of Legendre coefficients to keep
for the following runs. If you have saved the Legendre Green&#8217;s function in an
archive, you can then plot it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pytriqs.gf.local</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pytriqs.archive</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pytriqs.plot.mpl_interface</span> <span class="kn">import</span> <span class="n">oplot</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s">&quot;solution.h5&quot;</span><span class="p">)</span>
<span class="n">oplot</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="s">&#39;Gl&#39;</span><span class="p">][</span><span class="s">&#39;up&#39;</span><span class="p">],</span> <span class="s">&#39;-o&#39;</span><span class="p">,</span> <span class="n">x_window</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">45</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../build/doc/../../src/doc/legendre_plot.py">Source code</a>, <a class="reference external" href="../../build/doc/../../src/doc/legendre_plot.png">png</a>, <a class="reference external" href="../../build/doc/../../src/doc/legendre_plot.hires.png">hires.png</a>, <a class="reference external" href="../../build/doc/../../src/doc/legendre_plot.pdf">pdf</a>)</p>
<div class="figure">
<a class="reference internal image-reference" href="_images/legendre_plot.png"><img alt="_images/legendre_plot.png" src="_images/legendre_plot.png" style="width: 672.0px; height: 448.0px;" /></a>
</div>
<p>From this plot you see that for <span class="math">\(l &gt; 30\)</span>, the value of the
coefficient is of the order of the statistical noise. There is therefore no
information in the coefficients with <span class="math">\(l &gt; 30\)</span> and one can set
<tt class="docutils literal"><span class="pre">n_legendre</span> <span class="pre">=</span> <span class="pre">30</span></tt> for the following runs. Of course, if you will use
more statistics or a larger number of cores, you may have to reajust this
value.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="concept.html" title="The solver concept"
             >next</a> |</li>
        <li class="right" >
          <a href="reference.html" title="The Solver class"
             >previous</a> |</li>
    <li><a href="index.html">Home</a> &raquo;</li>

          <li><a href="documentation.html" >Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011-2013, M. Ferrero, O. Parcollet.
    </div>
  </body>
</html>